## Why e2e?
End to end testing is the only means of testing Millwright as of this writing. The reason for this
approach is twofold:

1. It's quick.
2. It's effective.

Using e2e as our sole means of testing is only temporary, as we expect substantial unit test
coverage before the 1.0.0 milestone.

## Overview
The tests are broken down into a single directory per test case. As of this writing, the only test
case is `master`, which is a sort of kitchen sink approach where we're (going to be) testing
everything. Feel free to add to that test case, or create a new one if you really feel it's the best
route. But keep in mind, the less crowded this directory is, the better.

When each test file (`<command>.test.js`) is run, the test case's sole `src` directory is processed
by whatever command is indicated in the test file name, and a `dest-<command>` directory is output
right there in the case directory. This new output is then compared to the existing
`dest-<command>-snapshot` directory. The test passes if the contents of the directories are the
same. The contents of the files themselves are used for comparison.

### Test case anatomy
Each test case is an individual mock project. The `src` directory is where the test is defined - it
simply contains the project, with whatever files you want to include for your test case.

Generally, each test case should run through the `make` and `build` commands, which is accomplished
via the `<command>.test.js` files. These files are just boilerplate, and will always have the same
content. This was a quick fix to take advantage of AVA's per-file sub-processing and async/await
transpiling. The actual test that we're reusing is written in `e2e/setup-src.js`, which is
transpiled via `e2e/setup.js`. The test file's name is used to determine which command to run, so
it's generally expected that every case will have a `make.test.js` and a `build.test.js`.

Finally, every test case should have a `dest-<command>snapshot` directory for each
`<command>.test.js` These directories are just static copies representing the exact `dest` output
that we expect when the test case is run with each command, respectively. There is not yet an
automated way to generate these directories. The `dest-<command>` directories that are generated by
the test suite are ignored for version control, and should not be committed.

### Writing e2e tests
To update an existing case, you'll need to do the following:

1. Update the `src` directory, which is where these tests are defined.
2. Run the test (it should fail).
3. Check the generated `dest-<command>` directories to ensure that contents are as expected. Using a
   diff is a good route for this.
4. If all is well, overwrite the existing `dest-<command>-snapshot` directory with the generated
   `dest-<command>` directory.

To create a new case:

1. Make a new directory within `e2e`. The directory name will be used as the test case name.
2. Copy the `*.test.js` files from an existing test case (they should have `build` and `make`
   variants).
3. Create a `src` directory, and define your mock project there.
4. Create empty `dest-<command>-snapshot` directories for each test file (again, should be `build`
   and `make`).
5. Follow steps 2 - 4 for updating an existing case.
